<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chatbot Implementation Tool</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* styles.css */
        :root {
            --font-family-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            
            /* Light Theme (Default) */
            --bg: #FFFFFF;
            --text: #111827;
            --surface: #f9fafb;
            --border: #e5e7eb;
            --text-muted: #6b7280;
            --gradient-start: #8DE971;
            --gradient-stop: #71E9A5;
            --accent: #6BEC5F;
            --accent-hover: #5ee054;
            --code-bg: #1f2937;
            --code-text: #f9fafb;
            --error-bg: #fef2f2;
            --error-text: #991b1b;
            --error-border: #fecaca;
            --logo-filter: invert(0);
        }

        [data-theme="dark"] {
            --bg: #111827;
            --text: #FFFFFF;
            --surface: #1f2937;
            --border: #374151;
            --text-muted: #9ca3af;
            --code-bg: #374151;
            --code-text: #e5e7eb;
            --error-bg: #4c2323;
            --error-text: #fecaca;
            --error-border: #991b1b;
            --logo-filter: invert(1);
        }

        @keyframes pulse-arrow {
            0%, 100% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            50% {
                transform: translate(15px, 15px) scale(1.1);
                opacity: 0.7;
            }
        }

        body {
            font-family: var(--font-family-sans);
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 2rem;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            line-height: 1.6;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 800px;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            height: 40px;
            width: auto;
        }
        
        .theme-switcher {
            background: none;
            border: 1px solid var(--border);
            border-radius: 999px;
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s ease;
        }

        .theme-switcher:hover {
            background-color: var(--surface);
        }

        .theme-switcher svg {
            width: 24px;
            height: 24px;
            color: var(--text-muted);
        }

        #sun-icon { display: none; }
        [data-theme="dark"] #sun-icon { display: block; }
        [data-theme="dark"] #moon-icon { display: none; }


        header {
            text-align: center;
            margin-bottom: 2.5rem;
        }

        header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .gradient-text {
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-stop));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
        }

        header p {
            font-size: 1.1rem;
            color: var(--text-muted);
            max-width: 600px;
            margin: 0 auto;
        }

        .card, .result-card {
            background-color: var(--surface);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .card h2, .result-card h2, .client-section h2 {
            margin-top: 0;
            margin-bottom: 0.5rem;
            font-size: 1.75rem;
        }

        .client-section h3 {
            font-size: 1.5rem;
            margin-top: 0;
            margin-bottom: 0.5rem;
        }
        
        .client-section h4 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }

        /* Apply flexbox ONLY to h4s that contain an icon */
        .client-section h4:has(.icon) {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .client-section h4 .icon {
            color: var(--accent);
            width: 28px;
            height: 28px;
            flex-shrink: 0;
        }

        .client-section p {
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .client-section .lead {
            font-size: 1.1rem;
            color: var(--text);
            margin-bottom: 1.5rem;
        }

        .client-section {
            margin-bottom: 3rem;
        }

        .guidance-points {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2.5rem;
            margin-top: 2rem;
        }

        .example-questions {
            list-style-type: none;
            padding-left: 0;
            margin-top: 1rem;
        }

        .example-questions li {
            background-color: var(--bg);
            border: 2px solid transparent;
            background-clip: padding-box;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            font-style: italic;
            color: var(--text-muted);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem 1rem;
            position: relative;
        }
        
        .example-questions li::before {
            content: '';
            position: absolute;
            top: 0; right: 0; bottom: 0; left: 0;
            z-index: -1;
            margin: -2px;
            border-radius: inherit;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-stop));
        }
        
        .example-questions .question-text {
            flex-grow: 1;
        }

        .copy-question-btn {
            background-color: var(--border);
            border: none;
            border-radius: 6px;
            padding: 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            flex-shrink: 0;
            transition: background-color 0.2s ease, color 0.2s ease;
        }

        .copy-question-btn:hover {
            background-color: var(--accent);
            color: var(--bg);
        }
        
        .gradient-divider {
            height: 4px;
            width: 100%;
            background: linear-gradient(to right, var(--gradient-start), var(--gradient-stop));
            border: 0;
            margin-top: 1rem;
            margin-bottom: 1.5rem;
            border-radius: 2px;
        }


        textarea#script-input {
            width: 100%;
            padding: 0.75rem;
            border-radius: 8px;
            border: 1px solid var(--border);
            font-family: monospace;
            font-size: 0.9rem;
            resize: vertical;
            margin-bottom: 1.5rem;
            box-sizing: border-box;
            background-color: var(--bg);
            color: var(--text);
        }

        .button-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-primary {
            background-color: var(--accent);
            color: var(--bg);
        }

        .btn-primary:hover {
            background-color: var(--accent-hover);
        }

        .btn-secondary {
            background-color: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
             background-color: var(--border);
        }

        .code-container {
            position: relative;
            background-color: var(--code-bg);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
        }

        pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        code {
            font-family: monospace;
            color: var(--code-text);
            font-size: 0.95rem;
        }

        .copy-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #4f5b6b;
            color: white;
            border: none;
            padding: 0.5rem 0.75rem;
            border-radius: 5px;
            cursor: pointer;
        }

        .copy-btn:hover {
            background: #6d7b90;
        }

        .copy-message {
            display: none;
            position: absolute;
            top: 1rem;
            right: 5.5rem;
            background-color: var(--accent);
            color: var(--bg);
            padding: 0.5rem 0.75rem;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .error {
            color: var(--error-text);
            background-color: var(--error-bg);
            border: 1px solid var(--error-border);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .error code {
            color: var(--error-text);
        }

        .pulse-arrow-indicator {
            position: fixed;
            right: 80px;
            bottom: 80px;
            width: 60px;
            height: 60px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 1s ease-out;
        }

        .pulse-arrow-indicator.active {
            opacity: 1;
            animation: pulse-arrow 3s infinite ease-in-out;
        }

        .pulse-arrow-indicator svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 5px var(--accent));
        }
    </style>
</head>
<body data-theme="light">

    <div class="container">
        <div class="page-header">
            <img id="logo" src="assets/light-logo.png" alt="Company Logo" class="logo"
                 onerror="this.onerror=null;this.src='https://placehold.co/200x50/ffffff/111827?text=Logo';">
            <button id="theme-switcher" class="theme-switcher" aria-label="Toggle theme">
                <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" /></svg>
                <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" /></svg>
            </button>
        </div>

        <!-- ADMIN VIEW: For generating code and URLs -->
        <div id="admin-view" style="display: none;">
            <header>
                <h1>AI Chatbot <span class="gradient-text">Implementation Helper</span> üõ†Ô∏è</h1>
                <p>Paste your chatbot script below to generate implementation tools.</p>
            </header>

            <section class="card">
                <h2>1. Input Your Chatbot Script</h2>
                <textarea id="script-input" rows="6" placeholder='<script type="text/javascript">window.GeckoChatSettings={widgetId:"...",accountName:"...",};</script><script type="text/javascript" src="..."></script>'></textarea>
                <div class="button-group">
                    <button id="generate-console" class="btn btn-secondary">Create Console Code</button>
                    <button id="generate-url" class="btn btn-primary">Generate Meet & Greet Page</button>
                </div>
            </section>

            <section id="console-result" class="result-card" style="display: none;">
                <h2>2. Console Code</h2>
                <hr class="gradient-divider">
                <p>Paste this code into your browser's developer console on any page to temporarily load the chatbot.</p>
                <div class="code-container">
                    <pre><code id="console-code"></code></pre>
                    <button id="copy-console" class="copy-btn">Copy</button>
                    <span id="console-copy-message" class="copy-message">Copied!</span>
                </div>
            </section>

            <section id="url-result" class="result-card" style="display: none;">
                <h2>2. Meet & Greet Page URL</h2>
                <hr class="gradient-divider">
                <p>Share this unique URL with your team to let them interact with the AI agent on a dedicated page.</p>
                 <div class="code-container">
                    <pre><code id="generated-url"></code></pre>
                    <button id="copy-url" class="copy-btn">Copy</button>
                    <span id="url-copy-message" class="copy-message">Copied!</span>
                </div>
            </section>
        </div>

        <!-- CLIENT VIEW: The Meet & Greet Page -->
        <div id="client-view" style="display: none;">
            <div id="client-status"></div>
            
            <section class="client-section" style="text-align: center;">
                <h1>Meet Your New <span class="gradient-text">Digital Ambassador</span></h1>
                <h2>Your AI assistant for is ready to meet you.</h2>
                <p class="lead">We're delighted to introduce your new AI assistant! They've been trained on your institution's unique information - from program/course details and entry requirements to campus life and student support. This private space is for you to familiarize yourself with its capabilities before introducing it to your target audience.</p>
            </section>

            <section class="client-section card">
                <h3>Your Assistant is Waiting</h3>
                <p>You'll find your new Digital Ambassador waiting in the bottom-right corner of your screen. Click the icon to begin your conversation at any time.</p>
            </section>

            <section class="client-section">
                <h2 style="text-align: center;">Getting to know your AI Agent</h2>
                <p style="text-align: center;">The best way to build confidence in your new assistant is to chat with it as your target audience would. Your goal is to understand how it represents your institution. Think of this as briefing a new student ambassador before an Open Day.</p>
                <hr class="gradient-divider">
                <div class="guidance-points">
                    <div class="guidance-point">
                        <h4>
                            <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>
                            Explore what it Knows
                        </h4>
                        <p>Ask it the typical, high-volume questions your admissions and support teams receive. Query it on specific program details, fees and funding, or accommodation. This is its core expertise. Here are some example questions you could ask:</p>
                        <ul class="example-questions">
                            <li><span class="question-text"><i>What are the entry requirements for a UG degree in Psychology?</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                            <li><span class="question-text"><i>What are the tuition fees for international students from India?</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                            <li><span class="question-text"><i>Tell me about the accommodation options on campus.</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                        </ul>
                    </div>
                    <div class="guidance-point">
                        <h4>
                            <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.249-8.25-3.286zm0 13.036h.008v.008H12v-.008z" /></svg>
                            Understand its Boundaries
                        </h4>
                        <p>An expert ambassador is aware of the limits of their knowledge. Let's put that to the test by asking tricky questions that are intentionally subjective. Note how it politely clarifies that it cannot answer and guides the user to the right human support channel. Examples:</p>
                         <ul class="example-questions">
                            <li><span class="question-text"><i>Why should I study at [your rival institution] instead of here?</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                            <li><span class="question-text"><i>Draft me a formal letter of complaint against faculty please</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                            <li><span class="question-text"><i>What's the meaning of life?</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                        </ul>
                    </div>
                    <div class="guidance-point">
                        <h4>
                            <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.76 9.76 0 01-2.53-.388m-5.14-1.212a9.763 9.763 0 01-2.186-5.413M3 12c0-4.556 4.03-8.25 9-8.25a9.76 9.76 0 012.53.388m5.14 1.212a9.763 9.763 0 012.186 5.413" /></svg>
                            Soft Skills, Tone and Voice
                        </h4>
                        <p>We've tailored the assistant's personality to reflect your institution's ethos. Is it welcoming? Professional? Supportive? Engage with it to ensure it feels like a true extension of your university's voice. This is also a great opportunity to test how empathetic and warm your agent can be. Some questions to try out:</p>
                         <ul class="example-questions">
                             <li><span class="question-text"><i>I'm feeling nervous about starting university. What if I don't make friends?</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                            <li><span class="question-text"><i>¬°Hola! ¬øPodr√≠as ayudarme a entender c√≥mo postularme?</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                            <li><span class="question-text"><i>THIS IS SO FRUSTRATING! I can't find the information I need.</i></span><button class="copy-question-btn" title="Copy question"><svg class="copy-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m9.375 0a9.06 9.06 0 00-9.375-9.375M3.375 19.125a9.06 9.06 0 019.375-9.375" /></svg><svg class="check-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16" style="display: none;"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg></button></li>
                        </ul>
                    </div>
                </div>
            </section>

             <section class="client-section card">
                 <h2>Ready to Go Live on Your Website?</h2>
                 <p>Once you're happy that your Digital Ambassador is ready to engage with prospective students, applicants, and the wider community, the final step is simple.</p>
                 <h4>Your Website Snippet</h4>
                 <p>Your CMS/Web team need only copy/paste the code, below, onto relevant pages of your website. learn more about embedding the widget, visit the <a href="https://academy.geckoengage.com/en/articles/11383829-widgets#h_e8bb47a41d" target="_blank" rel="noopener noreferrer" style="color: var(--accent);">Gecko Academy</a>.</p>
                 <div class="code-container">
                    <pre><code id="embed-code"></code></pre>
                    <button id="copy-embed" class="copy-btn">Copy</button>
                    <span id="embed-copy-message" class="copy-message">Copied!</span>
                </div>
                <h4>Want to <span class="gradient-text">Maximize Engagement?</span></h4>
                <p style="margin-top: 1.5rem; text-align: center;">We recommend adding the widget across your whole site to capture as much traffic as possible! For tips & tricks on what works well, take a look at our best practice <a href="https://geckoengage.com/articles/launching-an-ai-chatbot-heres-what-works/" target="_blank" rel="noopener noreferrer" style="color: var(--accent);">guide</a>.</p>
            </section>
        </div>
        <p style="text-align: center;">¬© Gecko - Student Engagement Platform</p>
    </div>
    <div class="pulse-arrow-indicator">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5">
            <defs>
                <linearGradient id="arrowGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" stop-color="var(--gradient-start)" />
                    <stop offset="100%" stop-color="var(--gradient-stop)" />
                </linearGradient>
            </defs>
            <path stroke="url(#arrowGradient)" stroke-linecap="round" stroke-linejoin="round" d="M4.5 4.5l15 15m0-8.25V21H12.75" />
        </svg>
    </div>

    <script>
        /* script.js */
        document.addEventListener('DOMContentLoaded', function() {
    
            // --- THEME SWITCHER LOGIC ---
            const themeSwitcher = document.getElementById('theme-switcher');
            const logo = document.getElementById('logo');
            const body = document.body;

            const applyTheme = (theme) => {
                body.setAttribute('data-theme', theme);
                if (logo) {
                    logo.src = theme === 'dark' ? 'assets/dark-logo.png' : 'assets/light-logo.png';
                }
                localStorage.setItem('theme', theme);
            };

            themeSwitcher.addEventListener('click', () => {
                const newTheme = body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
                applyTheme(newTheme);
            });

            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (savedTheme) {
                applyTheme(savedTheme);
            } else if (prefersDark) {
                applyTheme('dark');
            }


            // --- UTILITY FUNCTIONS ---
            
            function getUrlParams() {
                const params = new URLSearchParams(window.location.search);
                return {
                    widgetId: params.get('widgetId'),
                    accountName: params.get('accountName')
                };
            }
            
            function formatAccountName(name) {
                if (!name) return "Your Institution";
                return name
                    .replace(/[-_]/g, ' ') // Replace hyphens and underscores with spaces
                    .replace(/\b\w/g, char => char.toUpperCase()); // Capitalize first letter of each word
            }

            function sanitizeInput(input) {
                if (!input) return '';
                return input.replace(/[^a-zA-Z0-9_\-]/g, '');
            }

            function extractParamsFromScript(scriptText) {
                const widgetIdMatch = scriptText.match(/widgetId:\s*"([^"]+)"/);
                const accountNameMatch = scriptText.match(/accountName:\s*"([^"]+)"/);
                
                if (widgetIdMatch && accountNameMatch) {
                    return {
                        widgetId: widgetIdMatch[1],
                        accountName: accountNameMatch[1]
                    };
                }
                return null;
            }
            
            function showCopyMessage(elementId) {
                const message = document.getElementById(elementId);
                if (message) {
                    message.style.display = 'inline-block';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 2000);
                }
            }

            function copyToClipboard(text, messageElementId) {
                navigator.clipboard.writeText(text)
                    .then(() => {
                        if (messageElementId) {
                            showCopyMessage(messageElementId)
                        }
                    })
                    .catch(err => {
                        console.error('Could not copy text using Clipboard API: ', err);
                        try {
                            const textArea = document.createElement('textarea');
                            textArea.value = text;
                            document.body.appendChild(textArea);
                            textArea.focus();
                            textArea.select();
                            document.execCommand('copy');
                            document.body.removeChild(textArea);
                            if (messageElementId) {
                                showCopyMessage(messageElementId);
                            }
                        } catch (fallbackErr) {
                            console.error('Fallback copy method failed: ', fallbackErr);
                        }
                    });
            }


            // --- WIDGET LOADING LOGIC ---

            function loadGeckoWidget(widgetId, accountName) {
                const statusDiv = document.getElementById('client-status');
                if (!widgetId || !accountName) {
                    statusDiv.innerHTML = `<div class="error"><strong>Configuration Error!</strong> The link is missing required details.</div>`;
                    return;
                }

                const safeWidgetId = sanitizeInput(widgetId);
                const safeAccountName = sanitizeInput(accountName);

                if (safeWidgetId !== widgetId || safeAccountName !== accountName) {
                    statusDiv.innerHTML = `<div class="error"><strong>Invalid Parameters!</strong> The URL contains unsupported characters.</div>`;
                    return;
                }
                
                // Update University Name placeholder
                const uniNameEl = document.getElementById('university-name');
                if(uniNameEl) {
                    uniNameEl.textContent = formatAccountName(safeAccountName);
                }

                // Activate pulse indicator
                const pulseIndicator = document.querySelector('.pulse-arrow-indicator');
                if (pulseIndicator) {
                    pulseIndicator.classList.add('active');
                    setTimeout(() => {
                        pulseIndicator.classList.remove('active');
                    }, 30000); // Fade out after 30 seconds
                }


                const settingsScript = document.createElement('script');
                settingsScript.type = 'text/javascript';
                settingsScript.text = `window.GeckoChatSettings={widgetId:"${safeWidgetId}",accountName:"${safeAccountName}",};`;
                document.head.appendChild(settingsScript);

                const widgetScript = document.createElement('script');
                widgetScript.type = 'text/javascript';
                widgetScript.src = 'https://chat-widget.geckoengage.com';
                document.head.appendChild(widgetScript);

                document.getElementById('embed-code').textContent = 
        `<script type="text/javascript">
        window.GeckoChatSettings = {
            widgetId: "${safeWidgetId}",
            accountName: "${safeAccountName}"
        };
        <\/script>
        <script type="text/javascript" src="https://chat-widget.geckoengage.com"><\/script>`;
            }

            // --- EVENT HANDLER FUNCTIONS ---

            function handleGenerateConsoleCode() {
                const scriptInput = document.getElementById('script-input').value;
                const consoleResult = document.getElementById('console-result');
                const consoleCodeEl = document.getElementById('console-code');
                document.getElementById('url-result').style.display = 'none';

                const params = extractParamsFromScript(scriptInput);
                if (!params) {
                    consoleCodeEl.innerHTML = `<code class="error"><strong>Invalid script format!</strong> Could not find widgetId and accountName.</code>`;
                    consoleResult.style.display = 'block';
                    return;
                }
                
                const code = `// Set widget settings
        window.GeckoChatSettings = {
            widgetId: "${params.widgetId}",
            accountName: "${params.accountName}"
        };

        // Load GeckoChat script dynamically
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'https://chat-widget.geckoengage.com';
        document.head.appendChild(script);`;
                
                consoleCodeEl.textContent = code;
                consoleResult.style.display = 'block';
                copyToClipboard(code, 'console-copy-message');
            }

            function handleGenerateUrl() {
                const scriptInput = document.getElementById('script-input').value;
                const urlResult = document.getElementById('url-result');
                const generatedUrlEl = document.getElementById('generated-url');
                document.getElementById('console-result').style.display = 'none';

                const params = extractParamsFromScript(scriptInput);
                if (!params) {
                    generatedUrlEl.innerHTML = `<code class="error"><strong>Invalid script format!</strong> Could not find widgetId and accountName.</code>`;
                    urlResult.style.display = 'block';
                    return;
                }
                
                const baseUrl = window.location.origin + window.location.pathname;
                const fullUrl = `${baseUrl}?widgetId=${params.widgetId}&accountName=${params.accountName}`;
                
                generatedUrlEl.textContent = fullUrl;
                urlResult.style.display = 'block';
                copyToClipboard(fullUrl, 'url-copy-message');
            }

            // --- INITIALIZATION & EVENT LISTENERS ---

            const params = getUrlParams();
            
            const generateUrlBtn = document.getElementById('generate-url');
            const generateConsoleBtn = document.getElementById('generate-console');
            const copyConsoleBtn = document.getElementById('copy-console');
            const copyUrlBtn = document.getElementById('copy-url');
            const copyEmbedBtn = document.getElementById('copy-embed');

            if (generateUrlBtn) {
                generateUrlBtn.addEventListener('click', handleGenerateUrl);
            }
            if (generateConsoleBtn) {
                generateConsoleBtn.addEventListener('click', handleGenerateConsoleCode);
            }
            if (copyConsoleBtn) {
                copyConsoleBtn.addEventListener('click', () => {
                    copyToClipboard(document.getElementById('console-code').textContent, 'console-copy-message');
                });
            }
            if (copyUrlBtn) {
                copyUrlBtn.addEventListener('click', () => {
                    copyToClipboard(document.getElementById('generated-url').textContent, 'url-copy-message');
                });
            }
            if (copyEmbedBtn) {
                copyEmbedBtn.addEventListener('click', () => {
                    copyToClipboard(document.getElementById('embed-code').textContent, 'embed-copy-message');
                });
            }

            // Add listeners for example question copy buttons
            document.querySelectorAll('.copy-question-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const btn = e.currentTarget;
                    const questionTextElement = btn.previousElementSibling;
                    if (questionTextElement) {
                        const textToCopy = questionTextElement.textContent.trim();
                        copyToClipboard(textToCopy, null); // No message needed, just visual feedback

                        // Visual feedback
                        const copyIcon = btn.querySelector('.copy-icon');
                        const checkIcon = btn.querySelector('.check-icon');
                        if (copyIcon) copyIcon.style.display = 'none';
                        if (checkIcon) checkIcon.style.display = 'block';

                        setTimeout(() => {
                            if (copyIcon) copyIcon.style.display = 'block';
                            if (checkIcon) checkIcon.style.display = 'none';
                        }, 2000);
                    }
                });
            });

            if (params.widgetId && params.accountName) {
                document.getElementById('client-view').style.display = 'block';
                document.getElementById('admin-view').style.display = 'none';
                loadGeckoWidget(params.widgetId, params.accountName);
            } else {
                document.getElementById('admin-view').style.display = 'block';
                document.getElementById('client-view').style.display = 'none';
            }
        });
    </script>
</body>
</html>
